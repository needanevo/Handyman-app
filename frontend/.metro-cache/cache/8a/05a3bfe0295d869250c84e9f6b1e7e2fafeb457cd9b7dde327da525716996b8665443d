{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":78,"index":78}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"expo-secure-store","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":79},"end":{"line":2,"column":49,"index":128}}],"key":"BU2XtfznZ4PiVldqd/oueHCCaLo=","exportNames":["*"],"imports":1}},{"name":"../services/api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":129},"end":{"line":3,"column":42,"index":171}}],"key":"Pr5/EB33W7mJGi+ygccy+pUf1E8=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/src/contexts/AuthContext.tsx\";\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  exports.AuthProvider = AuthProvider;\n  exports.useAuth = useAuth;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _expoSecureStore = require(_dependencyMap[1], \"expo-secure-store\");\n  var SecureStore = _interopNamespace(_expoSecureStore);\n  var _servicesApi = require(_dependencyMap[2], \"../services/api\");\n  var _reactJsxDevRuntime = require(_dependencyMap[3], \"react/jsx-dev-runtime\");\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  function AuthProvider({\n    children\n  }) {\n    const [user, setUser] = (0, _react.useState)(null);\n    const [isLoading, setIsLoading] = (0, _react.useState)(true);\n    (0, _react.useEffect)(() => {\n      // Check for stored token on app start\n      checkAuthState();\n    }, []);\n    const checkAuthState = async () => {\n      try {\n        const token = await SecureStore.getItemAsync('accessToken');\n        if (token) {\n          // Set the token in API client\n          _servicesApi.authAPI.setAuthToken(token);\n          await refreshUser();\n        }\n      } catch (error) {\n        console.error('Auth state check failed:', error);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const login = async (email, password) => {\n      try {\n        setIsLoading(true);\n        const response = await _servicesApi.authAPI.login({\n          email,\n          password\n        });\n\n        // Store tokens securely\n        await SecureStore.setItemAsync('accessToken', response.access_token);\n        await SecureStore.setItemAsync('refreshToken', response.refresh_token);\n\n        // Set token in API client\n        _servicesApi.authAPI.setAuthToken(response.access_token);\n\n        // Fetch user data\n        await refreshUser();\n      } catch (error) {\n        console.error('Login failed:', error);\n        throw error;\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const register = async userData => {\n      try {\n        setIsLoading(true);\n        const response = await _servicesApi.authAPI.register(userData);\n\n        // Store tokens securely\n        await SecureStore.setItemAsync('accessToken', response.access_token);\n        await SecureStore.setItemAsync('refreshToken', response.refresh_token);\n\n        // Set token in API client\n        _servicesApi.authAPI.setAuthToken(response.access_token);\n\n        // Fetch user data\n        await refreshUser();\n      } catch (error) {\n        console.error('Registration failed:', error);\n        throw error;\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const refreshUser = async () => {\n      try {\n        const userData = await _servicesApi.authAPI.getCurrentUser();\n\n        // Transform backend data (snake_case) to frontend format (camelCase)\n        const transformedUser = {\n          id: userData.id,\n          email: userData.email,\n          firstName: userData.first_name,\n          lastName: userData.last_name,\n          role: userData.role,\n          phone: userData.phone,\n          addresses: userData.addresses || [],\n          isActive: userData.is_active\n        };\n        setUser(transformedUser);\n      } catch (error) {\n        console.error('Failed to refresh user:', error);\n        // If refresh fails, clear auth state\n        await logout();\n        throw error;\n      }\n    };\n    const logout = async () => {\n      try {\n        setIsLoading(true);\n\n        // Clear stored tokens\n        await SecureStore.deleteItemAsync('accessToken');\n        await SecureStore.deleteItemAsync('refreshToken');\n\n        // Clear API token\n        _servicesApi.authAPI.clearAuthToken();\n\n        // Clear user state\n        setUser(null);\n      } catch (error) {\n        console.error('Logout failed:', error);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const value = {\n      user,\n      isLoading,\n      isAuthenticated: !!user,\n      login,\n      register,\n      logout,\n      refreshUser\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: value,\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 10\n    }, this);\n  }\n  function useAuth() {\n    const context = (0, _react.useContext)(AuthContext);\n    if (context === undefined) {\n      throw new Error('useAuth must be used within an AuthProvider');\n    }\n    return context;\n  }\n});","lineCount":166,"map":[[23,2,48,0,"exports"],[23,9,48,0],[23,10,48,0,"AuthProvider"],[23,22,48,0],[23,25,48,0,"AuthProvider"],[23,37,48,0],[24,2,174,0,"exports"],[24,9,174,0],[24,10,174,0,"useAuth"],[24,17,174,0],[24,20,174,0,"useAuth"],[24,27,174,0],[25,2,1,0],[25,6,1,0,"_react"],[25,12,1,0],[25,15,1,0,"require"],[25,22,1,0],[25,23,1,0,"_dependencyMap"],[25,37,1,0],[26,2,2,0],[26,6,2,0,"_expoSecureStore"],[26,22,2,0],[26,25,2,0,"require"],[26,32,2,0],[26,33,2,0,"_dependencyMap"],[26,47,2,0],[27,2,2,0],[27,6,2,0,"SecureStore"],[27,17,2,0],[27,20,2,0,"_interopNamespace"],[27,37,2,0],[27,38,2,0,"_expoSecureStore"],[27,54,2,0],[28,2,3,0],[28,6,3,0,"_servicesApi"],[28,18,3,0],[28,21,3,0,"require"],[28,28,3,0],[28,29,3,0,"_dependencyMap"],[28,43,3,0],[29,2,3,42],[29,6,3,42,"_reactJsxDevRuntime"],[29,25,3,42],[29,28,3,42,"require"],[29,35,3,42],[29,36,3,42,"_dependencyMap"],[29,50,3,42],[30,2,46,0],[30,8,46,6,"AuthContext"],[30,19,46,17],[30,35,46,20],[30,39,46,20,"createContext"],[30,45,46,33],[30,46,46,33,"createContext"],[30,59,46,33],[30,61,46,63,"undefined"],[30,70,46,72],[30,71,46,73],[31,2,48,7],[31,11,48,16,"AuthProvider"],[31,23,48,28,"AuthProvider"],[31,24,48,29],[32,4,48,31,"children"],[33,2,48,71],[33,3,48,72],[33,5,48,74],[34,4,49,2],[34,10,49,8],[34,11,49,9,"user"],[34,15,49,13],[34,17,49,15,"setUser"],[34,24,49,22],[34,25,49,23],[34,28,49,26],[34,32,49,26,"useState"],[34,38,49,34],[34,39,49,34,"useState"],[34,47,49,34],[34,49,49,48],[34,53,49,52],[34,54,49,53],[35,4,50,2],[35,10,50,8],[35,11,50,9,"isLoading"],[35,20,50,18],[35,22,50,20,"setIsLoading"],[35,34,50,32],[35,35,50,33],[35,38,50,36],[35,42,50,36,"useState"],[35,48,50,44],[35,49,50,44,"useState"],[35,57,50,44],[35,59,50,45],[35,63,50,49],[35,64,50,50],[36,4,52,2],[36,8,52,2,"useEffect"],[36,14,52,11],[36,15,52,11,"useEffect"],[36,24,52,11],[36,26,52,12],[36,32,52,18],[37,6,53,4],[38,6,54,4,"checkAuthState"],[38,20,54,18],[38,21,54,19],[38,22,54,20],[39,4,55,2],[39,5,55,3],[39,7,55,5],[39,9,55,7],[39,10,55,8],[40,4,57,2],[40,10,57,8,"checkAuthState"],[40,24,57,22],[40,27,57,25],[40,33,57,25,"checkAuthState"],[40,34,57,25],[40,39,57,37],[41,6,58,4],[41,10,58,8],[42,8,59,6],[42,14,59,12,"token"],[42,19,59,17],[42,22,59,20],[42,28,59,26,"SecureStore"],[42,39,59,37],[42,40,59,38,"getItemAsync"],[42,52,59,50],[42,53,59,51],[42,66,59,64],[42,67,59,65],[43,8,60,6],[43,12,60,10,"token"],[43,17,60,15],[43,19,60,17],[44,10,61,8],[45,10,62,8,"authAPI"],[45,22,62,15],[45,23,62,15,"authAPI"],[45,30,62,15],[45,31,62,16,"setAuthToken"],[45,43,62,28],[45,44,62,29,"token"],[45,49,62,34],[45,50,62,35],[46,10,63,8],[46,16,63,14,"refreshUser"],[46,27,63,25],[46,28,63,26],[46,29,63,27],[47,8,64,6],[48,6,65,4],[48,7,65,5],[48,8,65,6],[48,15,65,13,"error"],[48,20,65,18],[48,22,65,20],[49,8,66,6,"console"],[49,15,66,13],[49,16,66,14,"error"],[49,21,66,19],[49,22,66,20],[49,48,66,46],[49,50,66,48,"error"],[49,55,66,53],[49,56,66,54],[50,6,67,4],[50,7,67,5],[50,16,67,14],[51,8,68,6,"setIsLoading"],[51,20,68,18],[51,21,68,19],[51,26,68,24],[51,27,68,25],[52,6,69,4],[53,4,70,2],[53,5,70,3],[54,4,72,2],[54,10,72,8,"login"],[54,15,72,13],[54,18,72,16],[54,24,72,16,"login"],[54,25,72,23,"email"],[54,30,72,36],[54,32,72,38,"password"],[54,40,72,54],[54,45,72,59],[55,6,73,4],[55,10,73,8],[56,8,74,6,"setIsLoading"],[56,20,74,18],[56,21,74,19],[56,25,74,23],[56,26,74,24],[57,8,75,6],[57,14,75,12,"response"],[57,22,75,20],[57,25,75,23],[57,31,75,29,"authAPI"],[57,43,75,36],[57,44,75,36,"authAPI"],[57,51,75,36],[57,52,75,37,"login"],[57,57,75,42],[57,58,75,43],[58,10,75,45,"email"],[58,15,75,50],[59,10,75,52,"password"],[60,8,75,61],[60,9,75,62],[60,10,75,63],[62,8,77,6],[63,8,78,6],[63,14,78,12,"SecureStore"],[63,25,78,23],[63,26,78,24,"setItemAsync"],[63,38,78,36],[63,39,78,37],[63,52,78,50],[63,54,78,52,"response"],[63,62,78,60],[63,63,78,61,"access_token"],[63,75,78,73],[63,76,78,74],[64,8,79,6],[64,14,79,12,"SecureStore"],[64,25,79,23],[64,26,79,24,"setItemAsync"],[64,38,79,36],[64,39,79,37],[64,53,79,51],[64,55,79,53,"response"],[64,63,79,61],[64,64,79,62,"refresh_token"],[64,77,79,75],[64,78,79,76],[66,8,81,6],[67,8,82,6,"authAPI"],[67,20,82,13],[67,21,82,13,"authAPI"],[67,28,82,13],[67,29,82,14,"setAuthToken"],[67,41,82,26],[67,42,82,27,"response"],[67,50,82,35],[67,51,82,36,"access_token"],[67,63,82,48],[67,64,82,49],[69,8,84,6],[70,8,85,6],[70,14,85,12,"refreshUser"],[70,25,85,23],[70,26,85,24],[70,27,85,25],[71,6,86,4],[71,7,86,5],[71,8,86,6],[71,15,86,13,"error"],[71,20,86,18],[71,22,86,20],[72,8,87,6,"console"],[72,15,87,13],[72,16,87,14,"error"],[72,21,87,19],[72,22,87,20],[72,37,87,35],[72,39,87,37,"error"],[72,44,87,42],[72,45,87,43],[73,8,88,6],[73,14,88,12,"error"],[73,19,88,17],[74,6,89,4],[74,7,89,5],[74,16,89,14],[75,8,90,6,"setIsLoading"],[75,20,90,18],[75,21,90,19],[75,26,90,24],[75,27,90,25],[76,6,91,4],[77,4,92,2],[77,5,92,3],[78,4,94,2],[78,10,94,8,"register"],[78,18,94,16],[78,21,94,19],[78,27,94,26,"userData"],[78,35,94,48],[78,39,94,53],[79,6,95,4],[79,10,95,8],[80,8,96,6,"setIsLoading"],[80,20,96,18],[80,21,96,19],[80,25,96,23],[80,26,96,24],[81,8,97,6],[81,14,97,12,"response"],[81,22,97,20],[81,25,97,23],[81,31,97,29,"authAPI"],[81,43,97,36],[81,44,97,36,"authAPI"],[81,51,97,36],[81,52,97,37,"register"],[81,60,97,45],[81,61,97,46,"userData"],[81,69,97,54],[81,70,97,55],[83,8,99,6],[84,8,100,6],[84,14,100,12,"SecureStore"],[84,25,100,23],[84,26,100,24,"setItemAsync"],[84,38,100,36],[84,39,100,37],[84,52,100,50],[84,54,100,52,"response"],[84,62,100,60],[84,63,100,61,"access_token"],[84,75,100,73],[84,76,100,74],[85,8,101,6],[85,14,101,12,"SecureStore"],[85,25,101,23],[85,26,101,24,"setItemAsync"],[85,38,101,36],[85,39,101,37],[85,53,101,51],[85,55,101,53,"response"],[85,63,101,61],[85,64,101,62,"refresh_token"],[85,77,101,75],[85,78,101,76],[87,8,103,6],[88,8,104,6,"authAPI"],[88,20,104,13],[88,21,104,13,"authAPI"],[88,28,104,13],[88,29,104,14,"setAuthToken"],[88,41,104,26],[88,42,104,27,"response"],[88,50,104,35],[88,51,104,36,"access_token"],[88,63,104,48],[88,64,104,49],[90,8,106,6],[91,8,107,6],[91,14,107,12,"refreshUser"],[91,25,107,23],[91,26,107,24],[91,27,107,25],[92,6,108,4],[92,7,108,5],[92,8,108,6],[92,15,108,13,"error"],[92,20,108,18],[92,22,108,20],[93,8,109,6,"console"],[93,15,109,13],[93,16,109,14,"error"],[93,21,109,19],[93,22,109,20],[93,44,109,42],[93,46,109,44,"error"],[93,51,109,49],[93,52,109,50],[94,8,110,6],[94,14,110,12,"error"],[94,19,110,17],[95,6,111,4],[95,7,111,5],[95,16,111,14],[96,8,112,6,"setIsLoading"],[96,20,112,18],[96,21,112,19],[96,26,112,24],[96,27,112,25],[97,6,113,4],[98,4,114,2],[98,5,114,3],[99,4,116,2],[99,10,116,8,"refreshUser"],[99,21,116,19],[99,24,116,22],[99,30,116,22,"refreshUser"],[99,31,116,22],[99,36,116,34],[100,6,117,4],[100,10,117,8],[101,8,118,6],[101,14,118,12,"userData"],[101,22,118,20],[101,25,118,23],[101,31,118,29,"authAPI"],[101,43,118,36],[101,44,118,36,"authAPI"],[101,51,118,36],[101,52,118,37,"getCurrentUser"],[101,66,118,51],[101,67,118,52],[101,68,118,53],[103,8,120,6],[104,8,121,6],[104,14,121,12,"transformedUser"],[104,29,121,33],[104,32,121,36],[105,10,122,8,"id"],[105,12,122,10],[105,14,122,12,"userData"],[105,22,122,20],[105,23,122,21,"id"],[105,25,122,23],[106,10,123,8,"email"],[106,15,123,13],[106,17,123,15,"userData"],[106,25,123,23],[106,26,123,24,"email"],[106,31,123,29],[107,10,124,8,"firstName"],[107,19,124,17],[107,21,124,19,"userData"],[107,29,124,27],[107,30,124,28,"first_name"],[107,40,124,38],[108,10,125,8,"lastName"],[108,18,125,16],[108,20,125,18,"userData"],[108,28,125,26],[108,29,125,27,"last_name"],[108,38,125,36],[109,10,126,8,"role"],[109,14,126,12],[109,16,126,14,"userData"],[109,24,126,22],[109,25,126,23,"role"],[109,29,126,27],[110,10,127,8,"phone"],[110,15,127,13],[110,17,127,15,"userData"],[110,25,127,23],[110,26,127,24,"phone"],[110,31,127,29],[111,10,128,8,"addresses"],[111,19,128,17],[111,21,128,19,"userData"],[111,29,128,27],[111,30,128,28,"addresses"],[111,39,128,37],[111,43,128,41],[111,45,128,43],[112,10,129,8,"isActive"],[112,18,129,16],[112,20,129,18,"userData"],[112,28,129,26],[112,29,129,27,"is_active"],[113,8,130,6],[113,9,130,7],[114,8,132,6,"setUser"],[114,15,132,13],[114,16,132,14,"transformedUser"],[114,31,132,29],[114,32,132,30],[115,6,133,4],[115,7,133,5],[115,8,133,6],[115,15,133,13,"error"],[115,20,133,18],[115,22,133,20],[116,8,134,6,"console"],[116,15,134,13],[116,16,134,14,"error"],[116,21,134,19],[116,22,134,20],[116,47,134,45],[116,49,134,47,"error"],[116,54,134,52],[116,55,134,53],[117,8,135,6],[118,8,136,6],[118,14,136,12,"logout"],[118,20,136,18],[118,21,136,19],[118,22,136,20],[119,8,137,6],[119,14,137,12,"error"],[119,19,137,17],[120,6,138,4],[121,4,139,2],[121,5,139,3],[122,4,141,2],[122,10,141,8,"logout"],[122,16,141,14],[122,19,141,17],[122,25,141,17,"logout"],[122,26,141,17],[122,31,141,29],[123,6,142,4],[123,10,142,8],[124,8,143,6,"setIsLoading"],[124,20,143,18],[124,21,143,19],[124,25,143,23],[124,26,143,24],[126,8,145,6],[127,8,146,6],[127,14,146,12,"SecureStore"],[127,25,146,23],[127,26,146,24,"deleteItemAsync"],[127,41,146,39],[127,42,146,40],[127,55,146,53],[127,56,146,54],[128,8,147,6],[128,14,147,12,"SecureStore"],[128,25,147,23],[128,26,147,24,"deleteItemAsync"],[128,41,147,39],[128,42,147,40],[128,56,147,54],[128,57,147,55],[130,8,149,6],[131,8,150,6,"authAPI"],[131,20,150,13],[131,21,150,13,"authAPI"],[131,28,150,13],[131,29,150,14,"clearAuthToken"],[131,43,150,28],[131,44,150,29],[131,45,150,30],[133,8,152,6],[134,8,153,6,"setUser"],[134,15,153,13],[134,16,153,14],[134,20,153,18],[134,21,153,19],[135,6,154,4],[135,7,154,5],[135,8,154,6],[135,15,154,13,"error"],[135,20,154,18],[135,22,154,20],[136,8,155,6,"console"],[136,15,155,13],[136,16,155,14,"error"],[136,21,155,19],[136,22,155,20],[136,38,155,36],[136,40,155,38,"error"],[136,45,155,43],[136,46,155,44],[137,6,156,4],[137,7,156,5],[137,16,156,14],[138,8,157,6,"setIsLoading"],[138,20,157,18],[138,21,157,19],[138,26,157,24],[138,27,157,25],[139,6,158,4],[140,4,159,2],[140,5,159,3],[141,4,161,2],[141,10,161,8,"value"],[141,15,161,30],[141,18,161,33],[142,6,162,4,"user"],[142,10,162,8],[143,6,163,4,"isLoading"],[143,15,163,13],[144,6,164,4,"isAuthenticated"],[144,21,164,19],[144,23,164,21],[144,24,164,22],[144,25,164,23,"user"],[144,29,164,27],[145,6,165,4,"login"],[145,11,165,9],[146,6,166,4,"register"],[146,14,166,12],[147,6,167,4,"logout"],[147,12,167,10],[148,6,168,4,"refreshUser"],[149,4,169,2],[149,5,169,3],[150,4,171,2],[150,24,171,9],[150,28,171,9,"_reactJsxDevRuntime"],[150,47,171,9],[150,48,171,9,"jsxDEV"],[150,54,171,9],[150,56,171,10,"AuthContext"],[150,67,171,21],[150,68,171,22,"Provider"],[150,76,171,30],[151,6,171,31,"value"],[151,11,171,36],[151,13,171,38,"value"],[151,18,171,44],[152,6,171,44,"children"],[152,14,171,44],[152,16,171,46,"children"],[153,4,171,54],[154,6,171,54,"fileName"],[154,14,171,54],[154,16,171,54,"_jsxFileName"],[154,28,171,54],[155,6,171,54,"lineNumber"],[155,16,171,54],[156,6,171,54,"columnNumber"],[156,18,171,54],[157,4,171,54],[157,11,171,77],[157,12,171,78],[158,2,172,0],[159,2,174,7],[159,11,174,16,"useAuth"],[159,18,174,23,"useAuth"],[159,19,174,23],[159,21,174,26],[160,4,175,2],[160,10,175,8,"context"],[160,17,175,15],[160,20,175,18],[160,24,175,18,"useContext"],[160,30,175,28],[160,31,175,28,"useContext"],[160,41,175,28],[160,43,175,29,"AuthContext"],[160,54,175,40],[160,55,175,41],[161,4,176,2],[161,8,176,6,"context"],[161,15,176,13],[161,20,176,18,"undefined"],[161,29,176,27],[161,31,176,29],[162,6,177,4],[162,12,177,10],[162,16,177,14,"Error"],[162,21,177,19],[162,22,177,20],[162,67,177,65],[162,68,177,66],[163,4,178,2],[164,4,179,2],[164,11,179,9,"context"],[164,18,179,16],[165,2,180,0],[166,0,180,1],[166,3]],"functionMap":{"names":["<global>","AuthProvider","useEffect$argument_0","checkAuthState","login","register","refreshUser","logout","useAuth"],"mappings":"AAA;OC+C;YCI;GDG;yBEE;GFa;gBGE;GHoB;mBIE;GJoB;sBKE;GLuB;iBME;GNkB;CDa;OQE;CRM"},"hasCjsExports":false},"type":"js/module"}]}